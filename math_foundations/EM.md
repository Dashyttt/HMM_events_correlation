# Expectation-Maximization Algorithm

Алгоритм Expectation-Maximization (EM) используется для инициализации параметров скрытой марковской модели (HMM).

## Назначение
- Вычисление матрицы переходов `A`
- Вычисление матрицы наблюдений `B`
- Определение начального распределения состояний `π`

## Этапы

1. **Инициализация** случайных параметров `A`, `B`, `π` с нормализацией.
2. **E-шаг (Expectation)**:
   - Вычисление прямых и обратных вероятностей (Forward/Backward).
   - Вычисление ожиданий по скрытым переменным.
3. **M-шаг (Maximization)**:
   - Обновление параметров `A`, `B`, `π` на основе полученных ожиданий.
4. Повторение до достижения сходимости (разность лог-правдоподобия < ε).

## Используемые формулы

- Прямые вероятности α:
  ```math
  α_t(i) = P(O_1, ..., O_t, q_t = S_i | λ)
  ```

- Обратные вероятности β:
  ```math
  β_t(i) = P(O_{t+1}, ..., O_T | q_t = S_i, λ)
  ```

- Вероятности перехода и состояния:
  ```math
  γ_t(i) = P(q_t = S_i | O, λ)
  ξ_t(i, j) = P(q_t = S_i, q_{t+1} = S_j | O, λ)