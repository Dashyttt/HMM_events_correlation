# Использование контекста при обучении HMM

## Зачем нужен контекст?

Классическая HMM обучается на последовательности событий, где каждое наблюдение обрабатывается изолированно. Однако в реальных сценариях (например, в информационной безопасности) **окружение события важно не меньше самого события**.

Контекст позволяет учитывать:

- **Временные зависимости** — что происходило до и после события  
- **Типы соседних событий** — например, резкое переключение из обычной активности в подозрительную  
- **Глобальные паттерны** в окне наблюдения

---

## Подход с градиентным контекстом

Контекст можно интерпретировать как **взвешенное окно вокруг текущего события**, где более близкие события имеют больший вес:

```math
Context_t = Σ_{i=-k}^{k} w_i * O_{t+i}

**Где:**

- `w_i` — вес события на позиции `t+i`
- `O` — наблюдение
- `k` — радиус окна (размер контекста слева и справа)
